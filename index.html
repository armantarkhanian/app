<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <script type="text/javascript" src="https://rawgit.com/centrifugal/centrifuge-js/master/dist/centrifuge.min.js"></script>
        <title>Centrifuge library chat example</title>
    </head>
    <body>
        <input type="text" id="input" />
        <script type="text/javascript">         
         const centrifuge = new Centrifuge('ws://localhost:8080/connection/websocket');
         function drawText(text) {
             const div = document.createElement('div');
             div.innerHTML = text + '<br>';
             document.body.appendChild(div);
         }
         centrifuge.on('connect', function(ctx){
             drawText('Connected over ' + ctx.transport);             
             centrifuge.rpc({"method": "like", "userID": "15", "photoID": "34"}).then(function(res) {
                 console.log('rpc result', res);
             }, function(err) {
                 console.log('rpc error', err);
             });

         });

         centrifuge.on('disconnect', function(ctx){
             drawText('Disconnected: ' + ctx.reason);
         });
         const sub = centrifuge.subscribe("chat", function(ctx) {
             document.getElementsByTagName("title")[0].innerHTML = JSON.stringify(ctx.data);
             drawText(JSON.stringify(ctx.data));
         })
         const input = document.getElementById("input");
         input.addEventListener('keyup', function(e) {
             if (e.keyCode === 13) {
                 sub.publish(this.value);
                 input.value = '';
             }
         });
         // After setting event handlers â€“ initiate actual connection with server.
         centrifuge.connect();

        </script>
    </body>
</html>
